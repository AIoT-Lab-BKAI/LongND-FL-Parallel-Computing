wandb: Currently logged in as: aiotlab (use `wandb login --relogin` to force relogin)
wandb: Tracking run with wandb version 0.12.9
wandb: Syncing run FedProx-Equal-1000-01
wandb:  View project at https://wandb.ai/aiotlab/federated-learning-dqn
wandb:  View run at https://wandb.ai/aiotlab/federated-learning-dqn/runs/5orocej0
wandb: Run data is saved locally in /local/9077916.1.gpu/9077916/wandb/run-20220129_201727-5orocej0
wandb: Run `wandb offline` to turn off syncing.

>>> START RUNNING: FedProx-Equal-1000-01 - Train mode: benchmark - Dataset: cifar100
Downloading https://www.cs.toronto.edu/~kriz/cifar-10-python.tar.gz to ./data/cifar/cifar-10-python.tar.gz
  0% 0/170498071 [00:00<?, ?it/s]  0% 1024/170498071 [00:00<8:16:31, 5723.03it/s]  0% 33792/170498071 [00:00<25:48, 110089.67it/s]  0% 50176/170498071 [00:00<27:55, 101714.15it/s]  0% 82944/170498071 [00:00<21:12, 133880.78it/s]  0% 115712/170498071 [00:00<18:43, 151598.54it/s]  0% 132096/170498071 [00:01<21:37, 131325.08it/s]  0% 164864/170498071 [00:01<19:09, 148208.94it/s]  0% 197632/170498071 [00:01<17:48, 159356.48it/s]  0% 214016/170498071 [00:01<20:31, 138329.17it/s]  0% 246784/170498071 [00:01<18:39, 152047.34it/s]  0% 279552/170498071 [00:01<17:34, 161443.72it/s]  0% 312320/170498071 [00:02<16:52, 168018.82it/s]  0% 345088/170498071 [00:02<16:28, 172166.67it/s]  0% 362496/170498071 [00:02<18:57, 149634.11it/s]  0% 394240/170498071 [00:02<17:56, 157971.57it/s]  0% 427008/170498071 [00:02<17:07, 165511.83it/s]  0% 459776/170498071 [00:03<17:44, 159754.54it/s]  0% 476160/170498071 [00:03<17:44, 159693.47it/s]  0% 508928/170498071 [00:03<16:59, 166735.63it/s]  0% 541696/170498071 [00:03<16:30, 171631.42it/s]  0% 574464/170498071 [00:03<16:11, 174981.90it/s]  0% 607232/170498071 [00:03<15:56, 177552.81it/s]  0% 640000/170498071 [00:04<15:42, 180204.79it/s]  0% 689152/170498071 [00:04<15:22, 184117.31it/s]  0% 721920/170498071 [00:04<14:32, 194572.92it/s]  0% 754688/170498071 [00:04<14:46, 191411.78it/s]  0% 787456/170498071 [00:04<14:05, 200835.14it/s]  0% 836608/170498071 [00:05<14:18, 197549.24it/s]  1% 869376/170498071 [00:05<13:46, 205299.45it/s]  1% 902144/170498071 [00:05<13:12, 213866.54it/s]  1% 951296/170498071 [00:05<13:05, 215910.30it/s]  1% 1000448/170498071 [00:05<12:54, 218874.27it/s]  1% 1049600/170498071 [00:05<12:06, 233379.70it/s]  1% 1098752/170498071 [00:06<11:29, 245515.85it/s]  1% 1147904/170498071 [00:06<11:08, 253494.38it/s]  1% 1197056/170498071 [00:06<10:12, 276229.74it/s]  1% 1246208/170498071 [00:06<09:19, 302272.61it/s]  1% 1295360/170498071 [00:06<08:54, 316814.32it/s]  1% 1328128/170498071 [00:06<09:27, 298069.78it/s]  1% 1393664/170498071 [00:07<08:09, 345798.97it/s]  1% 1442816/170498071 [00:07<07:53, 357120.85it/s]  1% 1524736/170498071 [00:07<07:11, 391635.83it/s]  1% 1606656/170498071 [00:07<06:19, 445288.07it/s]  1% 1655808/170498071 [00:07<06:35, 426878.46it/s]  1% 1737728/170498071 [00:07<05:58, 471079.10it/s]  1% 1819648/170498071 [00:07<05:27, 515209.32it/s]  1% 1901568/170498071 [00:07<05:11, 540935.44it/s]  1% 1967104/170498071 [00:08<05:18, 528676.51it/s]  1% 2065408/170498071 [00:08<04:25, 634087.20it/s]  1% 2147328/170498071 [00:08<04:24, 635979.04it/s]  1% 2229248/170498071 [00:08<04:26, 630930.90it/s]  1% 2343936/170498071 [00:08<04:02, 694458.16it/s]  1% 2458624/170498071 [00:08<03:43, 751270.32it/s]  1% 2556928/170498071 [00:08<03:27, 807670.12it/s]  2% 2671616/170498071 [00:08<03:23, 823713.88it/s]  2% 2786304/170498071 [00:09<03:16, 855198.22it/s]  2% 2884608/170498071 [00:09<03:09, 886196.11it/s]  2% 3032064/170498071 [00:09<02:55, 954530.10it/s]  2% 3179520/170498071 [00:09<02:45, 1013219.86it/s]  2% 3294208/170498071 [00:09<02:39, 1046456.20it/s]  2% 3441664/170498071 [00:09<02:34, 1078633.41it/s]  2% 3621888/170498071 [00:09<02:22, 1171557.14it/s]  2% 3752960/170498071 [00:09<02:19, 1197741.33it/s]  2% 3933184/170498071 [00:10<02:11, 1262599.45it/s]  2% 4113408/170498071 [00:10<02:06, 1320366.58it/s]  2% 4245504/170498071 [00:10<02:06, 1316692.75it/s]  3% 4473856/170498071 [00:10<01:54, 1444911.27it/s]  3% 4686848/170498071 [00:10<01:42, 1613534.63it/s]  3% 4849664/170498071 [00:10<01:48, 1519920.80it/s]  3% 5080064/170498071 [00:10<01:36, 1722740.06it/s]  3% 5256192/170498071 [00:10<01:35, 1725753.00it/s]  3% 5440512/170498071 [00:10<01:37, 1696750.94it/s]  3% 5686272/170498071 [00:11<01:26, 1895022.71it/s]  3% 5878784/170498071 [00:11<01:32, 1786026.53it/s]  4% 6161408/170498071 [00:11<01:19, 2055261.98it/s]  4% 6371328/170498071 [00:11<01:20, 2039862.82it/s]  4% 6587392/170498071 [00:11<01:20, 2044569.40it/s]  4% 6865920/170498071 [00:11<01:12, 2249986.22it/s]  4% 7093248/170498071 [00:11<01:16, 2129304.48it/s]  4% 7422976/170498071 [00:11<01:06, 2443014.38it/s]  4% 7670784/170498071 [00:11<01:08, 2376102.90it/s]  5% 7963648/170498071 [00:12<01:05, 2489765.66it/s]  5% 8274944/170498071 [00:12<01:01, 2656095.45it/s]  5% 8543232/170498071 [00:12<01:04, 2526895.11it/s]  5% 8946688/170498071 [00:12<00:55, 2925238.26it/s]  5% 9243648/170498071 [00:12<00:56, 2841433.95it/s]  6% 9585664/170498071 [00:12<00:53, 2983413.40it/s]  6% 9946112/170498071 [00:12<00:51, 3147631.54it/s]  6% 10263552/170498071 [00:12<00:53, 2990861.41it/s]  6% 10716160/170498071 [00:12<00:46, 3418164.40it/s]  6% 11063296/170498071 [00:13<00:47, 3330839.35it/s]  7% 11486208/170498071 [00:13<00:45, 3484819.09it/s]  7% 11895808/170498071 [00:13<00:43, 3652409.98it/s]  7% 12264448/170498071 [00:13<00:44, 3523458.69it/s]  7% 12780544/170498071 [00:13<00:39, 3963292.22it/s]  8% 13180928/170498071 [00:13<00:40, 3898112.44it/s]  8% 13681664/170498071 [00:13<00:38, 4035502.36it/s]  8% 14156800/170498071 [00:13<00:37, 4211901.44it/s]  9% 14582784/170498071 [00:13<00:38, 4081294.79it/s]  9% 15205376/170498071 [00:13<00:33, 4684129.57it/s]  9% 15678464/170498071 [00:14<00:34, 4549578.58it/s] 10% 16221184/170498071 [00:14<00:33, 4659081.44it/s] 10% 16761856/170498071 [00:14<00:31, 4819819.10it/s] 10% 17253376/170498071 [00:14<00:32, 4673627.07it/s] 11% 17974272/170498071 [00:14<00:28, 5373592.89it/s] 11% 18516992/170498071 [00:14<00:29, 5177126.59it/s] 11% 19121152/170498071 [00:14<00:28, 5346448.34it/s] 12% 19760128/170498071 [00:14<00:26, 5586480.20it/s] 12% 20322304/170498071 [00:14<00:28, 5341545.66it/s] 12% 21169152/170498071 [00:15<00:24, 6159622.74it/s] 13% 21791744/170498071 [00:15<00:25, 5890310.10it/s] 13% 22463488/170498071 [00:15<00:24, 6077270.37it/s] 14% 23135232/170498071 [00:15<00:23, 6255054.59it/s] 14% 23774208/170498071 [00:15<00:24, 6055552.81it/s] 14% 24691712/170498071 [00:15<00:21, 6914520.16it/s] 15% 25390080/170498071 [00:15<00:21, 6862106.07it/s] 15% 26199040/170498071 [00:15<00:20, 6943897.35it/s] 16% 26952704/170498071 [00:15<00:20, 7079166.87it/s] 16% 27706368/170498071 [00:16<00:19, 7206330.58it/s] 17% 28525568/170498071 [00:16<00:18, 7478006.48it/s] 17% 29276160/170498071 [00:16<00:19, 7263755.06it/s] 18% 30327808/170498071 [00:16<00:17, 8186723.71it/s] 18% 31152128/170498071 [00:16<00:17, 8048785.16it/s] 19% 31998976/170498071 [00:16<00:17, 8091773.96it/s] 19% 32932864/170498071 [00:16<00:16, 8367328.84it/s] 20% 33772544/170498071 [00:16<00:16, 8156067.04it/s] 20% 34882560/170498071 [00:16<00:15, 8983168.29it/s] 21% 35785728/170498071 [00:16<00:15, 8551497.64it/s] 22% 36946944/170498071 [00:17<00:14, 9299618.40it/s] 22% 37883904/170498071 [00:17<00:14, 9251665.90it/s] 23% 38896640/170498071 [00:17<00:14, 9187516.35it/s] 24% 40190976/170498071 [00:17<00:12, 10232915.65it/s] 24% 41222144/170498071 [00:17<00:13, 9706551.22it/s]  25% 42468352/170498071 [00:17<00:12, 10475990.72it/s] 26% 43528192/170498071 [00:17<00:12, 10354384.96it/s] 26% 44663808/170498071 [00:17<00:12, 10326097.50it/s] 27% 46072832/170498071 [00:17<00:10, 11390720.76it/s] 28% 47221760/170498071 [00:18<00:11, 10706765.21it/s] 29% 48645120/170498071 [00:18<00:10, 11676886.14it/s] 29% 49829888/170498071 [00:18<00:10, 11507483.05it/s] 30% 51053568/170498071 [00:18<00:10, 11521679.27it/s] 31% 52626432/170498071 [00:18<00:09, 12673888.62it/s] 32% 53904384/170498071 [00:18<00:09, 12061453.97it/s] 33% 55444480/170498071 [00:18<00:08, 12978416.55it/s] 33% 56756224/170498071 [00:18<00:08, 12704207.45it/s] 34% 58131456/170498071 [00:18<00:08, 12749998.19it/s] 35% 59900928/170498071 [00:19<00:07, 14112052.81it/s] 36% 61323264/170498071 [00:19<00:08, 13274355.52it/s] 37% 63046656/170498071 [00:19<00:07, 14359380.85it/s] 38% 64501760/170498071 [00:19<00:07, 14136554.82it/s] 39% 65963008/170498071 [00:19<00:07, 14091656.49it/s] 40% 67879936/170498071 [00:19<00:06, 15543109.07it/s] 41% 69447680/170498071 [00:19<00:06, 14717255.19it/s] 42% 71304192/170498071 [00:19<00:06, 15755872.52it/s] 43% 72897536/170498071 [00:19<00:06, 15419718.86it/s] 44% 74564608/170498071 [00:19<00:06, 15444930.35it/s] 45% 76334080/170498071 [00:20<00:05, 15874634.39it/s] 46% 77929472/170498071 [00:20<00:06, 15056784.38it/s] 47% 80462848/170498071 [00:20<00:05, 17929249.89it/s] 48% 82284544/170498071 [00:20<00:05, 17530074.07it/s] 49% 84059136/170498071 [00:20<00:04, 17373189.30it/s] 50% 85811200/170498071 [00:20<00:05, 16465538.71it/s] 51% 87475200/170498071 [00:20<00:05, 15954015.95it/s] 53% 90407936/170498071 [00:20<00:04, 19653405.54it/s] 54% 92410880/170498071 [00:21<00:04, 16959560.93it/s] 55% 94193664/170498071 [00:21<00:04, 16234314.84it/s] 57% 97453056/170498071 [00:21<00:04, 16735769.80it/s] 59% 101188608/170498071 [00:21<00:03, 17866827.48it/s] 61% 104776704/170498071 [00:21<00:03, 18316407.28it/s] 63% 108233728/170498071 [00:21<00:03, 18416733.56it/s] 66% 111920128/170498071 [00:22<00:03, 18809801.69it/s] 68% 115655680/170498071 [00:22<00:02, 19128081.86it/s] 70% 119325696/170498071 [00:22<00:02, 19254481.20it/s] 72% 123012096/170498071 [00:22<00:02, 19358878.55it/s] 74% 126551040/170498071 [00:22<00:02, 19246410.49it/s] 76% 130171904/170498071 [00:22<00:02, 19279025.60it/s] 78% 133645312/170498071 [00:23<00:01, 19082338.49it/s] 81% 137331712/170498071 [00:23<00:01, 19221855.97it/s] 83% 141001728/170498071 [00:23<00:01, 19334178.45it/s] 85% 144606208/170498071 [00:23<00:01, 19314097.45it/s] 87% 148325376/170498071 [00:23<00:01, 19433280.07it/s] 89% 151995392/170498071 [00:24<00:00, 19476393.86it/s] 91% 155665408/170498071 [00:24<00:00, 19508067.49it/s] 94% 159417344/170498071 [00:24<00:00, 19635756.02it/s] 96% 163120128/170498071 [00:24<00:00, 19660542.37it/s] 98% 166790144/170498071 [00:24<00:00, 19635683.03it/s]100% 170083328/170498071 [00:25<00:00, 19113897.59it/s]170499072it [00:25, 6802476.04it/s]                    
Extracting ./data/cifar/cifar-10-python.tar.gz to ./data/cifar/
Files already downloaded and verified
Sequential(
  (0): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  (1): ReLU(inplace=True)
  (2): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (3): Conv2d(64, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  (4): ReLU(inplace=True)
  (5): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (6): Conv2d(128, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  (7): ReLU(inplace=True)
  (8): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  (9): ReLU(inplace=True)
  (10): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (11): Conv2d(256, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  (12): ReLU(inplace=True)
  (13): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  (14): ReLU(inplace=True)
  (15): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (16): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  (17): ReLU(inplace=True)
  (18): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  (19): ReLU(inplace=True)
  (20): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (21): Flatten(start_dim=1, end_dim=-1)
  (22): Dropout(p=0.5, inplace=False)
  (23): Linear(in_features=512, out_features=512, bias=True)
  (24): ReLU(inplace=True)
  (25): Dropout(p=0.5, inplace=False)
  (26): Linear(in_features=512, out_features=512, bias=True)
  (27): ReLU(inplace=True)
  (28): Linear(in_features=512, out_features=100, bias=True)
)
Init State dim 300
Init Action dim 200
  0% 0/1000 [00:00<?, ?it/s]ROUND:  0
[5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
ROUND:  0  TEST ACC:  0.0438
  0% 1/1000 [00:39<10:54:30, 39.31s/it]ROUND:  1
[5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
  0% 1/1000 [00:42<11:54:46, 42.93s/it]
Traceback (most recent call last):
  File "train.py", line 340, in <module>
    main(args)
  File "train.py", line 198, in main
    [
  File "train.py", line 202, in <listcomp>
    copy.deepcopy(client_model),
  File "/apps/centos7/python/3.8.7/lib/python3.8/copy.py", line 172, in deepcopy
    y = _reconstruct(x, memo, *rv)
  File "/apps/centos7/python/3.8.7/lib/python3.8/copy.py", line 270, in _reconstruct
    state = deepcopy(state, memo)
  File "/apps/centos7/python/3.8.7/lib/python3.8/copy.py", line 146, in deepcopy
    y = copier(x, memo)
  File "/apps/centos7/python/3.8.7/lib/python3.8/copy.py", line 230, in _deepcopy_dict
    y[deepcopy(key, memo)] = deepcopy(value, memo)
  File "/apps/centos7/python/3.8.7/lib/python3.8/copy.py", line 172, in deepcopy
    y = _reconstruct(x, memo, *rv)
  File "/apps/centos7/python/3.8.7/lib/python3.8/copy.py", line 296, in _reconstruct
    value = deepcopy(value, memo)
  File "/apps/centos7/python/3.8.7/lib/python3.8/copy.py", line 172, in deepcopy
    y = _reconstruct(x, memo, *rv)
  File "/apps/centos7/python/3.8.7/lib/python3.8/copy.py", line 270, in _reconstruct
    state = deepcopy(state, memo)
  File "/apps/centos7/python/3.8.7/lib/python3.8/copy.py", line 146, in deepcopy
    y = copier(x, memo)
  File "/apps/centos7/python/3.8.7/lib/python3.8/copy.py", line 230, in _deepcopy_dict
    y[deepcopy(key, memo)] = deepcopy(value, memo)
  File "/apps/centos7/python/3.8.7/lib/python3.8/copy.py", line 172, in deepcopy
    y = _reconstruct(x, memo, *rv)
  File "/apps/centos7/python/3.8.7/lib/python3.8/copy.py", line 296, in _reconstruct
    value = deepcopy(value, memo)
  File "/apps/centos7/python/3.8.7/lib/python3.8/copy.py", line 153, in deepcopy
    y = copier(memo)
  File "/home/acc13085dy/federated-learning/FLenv/lib/python3.8/site-packages/torch/nn/parameter.py", line 32, in __deepcopy__
    result = type(self)(self.data.clone(memory_format=torch.preserve_format), self.requires_grad)
RuntimeError: CUDA out of memory. Tried to allocate 20.00 MiB (GPU 0; 15.78 GiB total capacity; 453.21 MiB already allocated; 10.00 MiB free; 478.00 MiB reserved in total by PyTorch)

wandb: Waiting for W&B process to finish, PID 180693... (failed 1). Press ctrl-c to abort syncing.
wandb: - 0.00MB of 0.00MB uploaded (0.00MB deduped)wandb: \ 0.00MB of 0.00MB uploaded (0.00MB deduped)wandb: | 0.00MB of 0.01MB uploaded (0.00MB deduped)wandb: / 0.00MB of 0.01MB uploaded (0.00MB deduped)wandb: - 0.00MB of 0.01MB uploaded (0.00MB deduped)wandb: \ 0.01MB of 0.01MB uploaded (0.00MB deduped)wandb: | 0.01MB of 0.01MB uploaded (0.00MB deduped)wandb: / 0.01MB of 0.01MB uploaded (0.00MB deduped)wandb: - 0.01MB of 0.01MB uploaded (0.00MB deduped)wandb: \ 0.01MB of 0.01MB uploaded (0.00MB deduped)wandb: | 0.01MB of 0.01MB uploaded (0.00MB deduped)wandb: / 0.01MB of 0.01MB uploaded (0.00MB deduped)wandb:                                                                                
wandb: Run history:
wandb:   test_acc ▁
wandb: 
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Synced FedProx-Equal-1000-01: https://wandb.ai/aiotlab/federated-learning-dqn/runs/5orocej0
wandb: Find logs at: ./wandb/run-20220129_201727-5orocej0/logs/debug.log
wandb: 
