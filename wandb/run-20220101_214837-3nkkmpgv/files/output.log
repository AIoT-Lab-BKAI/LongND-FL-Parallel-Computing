
./
Train :------------------------------
[5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
  0%|                                                   | 0/196 [00:00<?, ?it/s]
Client : 0 Number sample : 1960 Epoch : 0   Ep loss : 0.17456698767384704
100%|████████████████████████████████████████| 196/196 [00:01<00:00, 191.67it/s]
100%|████████████████████████████████████████| 196/196 [00:01<00:00, 186.21it/s]
100%|████████████████████████████████████████| 196/196 [00:00<00:00, 213.97it/s]
 69%|███████████████████████████▌            | 135/196 [00:00<00:00, 196.93it/s]
Client : 0 Number sample : 1960 Epoch : 1   Ep loss : 0.16674923733332936
Client : 2 Number sample : 1960 Epoch : 1   Ep loss : 0.1713018481220518
Client : 0 Number sample : 1960 Epoch : 2   Ep loss : 0.15162271474088942
100%|████████████████████████████████████████| 196/196 [00:01<00:00, 195.96it/s]
100%|████████████████████████████████████████| 196/196 [00:01<00:00, 191.46it/s]
100%|████████████████████████████████████████| 196/196 [00:00<00:00, 202.13it/s]
 53%|█████████████████████                   | 103/196 [00:00<00:00, 203.44it/s]
Client : 0 Number sample : 1960 Epoch : 3   Ep loss : 0.14265490912509207
Client : 2 Number sample : 1960 Epoch : 3   Ep loss : 0.14647191717308394
Client : 0 Number sample : 1960 Epoch : 4   Ep loss : 0.13489674461283246
100%|████████████████████████████████████████| 196/196 [00:00<00:00, 200.17it/s]
100%|████████████████████████████████████████| 196/196 [00:01<00:00, 185.06it/s]
100%|████████████████████████████████████████| 196/196 [00:01<00:00, 195.19it/s]
100%|████████████████████████████████████████| 196/196 [00:01<00:00, 185.81it/s]
 51%|████████████████████▋                    | 99/196 [00:00<00:00, 185.39it/s]
Client : 1 Number sample : 1960 Epoch : 0   Ep loss : 0.17965546261747273
Client : 3 Number sample : 1960 Epoch : 0   Ep loss : 0.177875585511935
Client : 1 Number sample : 1960 Epoch : 1   Ep loss : 0.16918568225691513
100%|████████████████████████████████████████| 196/196 [00:01<00:00, 195.92it/s]
100%|████████████████████████████████████████| 196/196 [00:01<00:00, 180.92it/s]
100%|████████████████████████████████████████| 196/196 [00:01<00:00, 195.43it/s]
100%|████████████████████████████████████████| 196/196 [00:01<00:00, 181.05it/s]
  0%|                                                   | 0/196 [00:00<?, ?it/s]
Client : 1 Number sample : 1960 Epoch : 2   Ep loss : 0.15655155019948677
Client : 3 Number sample : 1960 Epoch : 2   Ep loss : 0.158851633076461
100%|████████████████████████████████████████| 196/196 [00:01<00:00, 194.08it/s]
100%|████████████████████████████████████████| 196/196 [00:01<00:00, 182.46it/s]
100%|████████████████████████████████████████| 196/196 [00:01<00:00, 183.13it/s]
 89%|███████████████████████████████████▋    | 175/196 [00:00<00:00, 171.89it/s]
Client : 3 Number sample : 1960 Epoch : 3   Ep loss : 0.1520984671553787
Client : 1 Number sample : 1960 Epoch : 4   Ep loss : 0.14227199444205177
Client : 3 Number sample : 1960 Epoch : 4   Ep loss : 0.146630748840315
100%|████████████████████████████████████████| 196/196 [00:01<00:00, 177.43it/s]
100%|████████████████████████████████████████| 196/196 [00:01<00:00, 179.29it/s]
100%|████████████████████████████████████████| 196/196 [00:01<00:00, 177.80it/s]
100%|████████████████████████████████████████| 196/196 [00:01<00:00, 170.53it/s]
 73%|█████████████████████████████▏          | 143/196 [00:00<00:00, 194.30it/s]
Client : 6 Number sample : 1960 Epoch : 0   Ep loss : 0.17308209961926452
Client : 4 Number sample : 1960 Epoch : 1   Ep loss : 0.17298769293238922
Client : 6 Number sample : 1960 Epoch : 1   Ep loss : 0.17283959029128357
100%|████████████████████████████████████████| 196/196 [00:01<00:00, 190.70it/s]
100%|████████████████████████████████████████| 196/196 [00:01<00:00, 178.16it/s]
100%|████████████████████████████████████████| 196/196 [00:01<00:00, 190.22it/s]
100%|████████████████████████████████████████| 196/196 [00:01<00:00, 195.80it/s]
 49%|████████████████████                     | 96/196 [00:00<00:00, 181.07it/s]
Client : 6 Number sample : 1960 Epoch : 2   Ep loss : 0.17545556721790712
Client : 4 Number sample : 1960 Epoch : 3   Ep loss : 0.15066611147200576
Client : 6 Number sample : 1960 Epoch : 3   Ep loss : 0.1737180075475148
100%|████████████████████████████████████████| 196/196 [00:01<00:00, 176.81it/s]
100%|████████████████████████████████████████| 196/196 [00:01<00:00, 173.82it/s]
100%|████████████████████████████████████████| 196/196 [00:01<00:00, 159.27it/s]
100%|████████████████████████████████████████| 196/196 [00:00<00:00, 203.69it/s]
 11%|████▍                                    | 21/196 [00:00<00:00, 209.38it/s]
Client : 6 Number sample : 1960 Epoch : 4   Ep loss : 0.17329569879387105
100%|████████████████████████████████████████| 196/196 [00:01<00:00, 191.92it/s]
100%|████████████████████████████████████████| 196/196 [00:01<00:00, 179.65it/s]
 91%|████████████████████████████████████▎   | 178/196 [00:00<00:00, 181.74it/s]
Client : 5 Number sample : 1960 Epoch : 1   Ep loss : 0.17128669371714397
Client : 7 Number sample : 1960 Epoch : 0   Ep loss : 0.18694018268463564
Client : 7 Number sample : 1960 Epoch : 1   Ep loss : 0.17842493662420583
100%|████████████████████████████████████████| 196/196 [00:01<00:00, 178.06it/s]
100%|████████████████████████████████████████| 196/196 [00:01<00:00, 143.45it/s]
100%|████████████████████████████████████████| 196/196 [00:01<00:00, 155.05it/s]
100%|████████████████████████████████████████| 196/196 [00:01<00:00, 118.82it/s]
 28%|███████████▌                             | 55/196 [00:00<00:00, 169.72it/s]
Client : 7 Number sample : 1960 Epoch : 2   Ep loss : 0.17744665516882527
100%|████████████████████████████████████████| 196/196 [00:01<00:00, 135.38it/s]
100%|████████████████████████████████████████| 196/196 [00:01<00:00, 140.23it/s]
 78%|███████████████████████████████         | 152/196 [00:00<00:00, 171.06it/s]
Client : 7 Number sample : 1960 Epoch : 3   Ep loss : 0.17532030002651167
Client : 5 Number sample : 1960 Epoch : 4   Ep loss : 0.14787737998579228
Client : 7 Number sample : 1960 Epoch : 4   Ep loss : 0.17371903587968981
100%|████████████████████████████████████████| 196/196 [00:01<00:00, 151.20it/s]
100%|████████████████████████████████████████| 196/196 [00:01<00:00, 161.59it/s]
100%|████████████████████████████████████████| 196/196 [00:01<00:00, 157.46it/s]
100%|████████████████████████████████████████| 196/196 [00:01<00:00, 159.40it/s]
 43%|█████████████████▊                       | 85/196 [00:00<00:00, 207.81it/s]
Client : 8 Number sample : 1960 Epoch : 1   Ep loss : 0.17927955395104933
100%|████████████████████████████████████████| 196/196 [00:00<00:00, 206.31it/s]
100%|████████████████████████████████████████| 196/196 [00:00<00:00, 205.67it/s]
 54%|█████████████████████▋                  | 106/196 [00:00<00:00, 204.43it/s]
Client : 8 Number sample : 1960 Epoch : 3   Ep loss : 0.17200343774593607
100%|████████████████████████████████████████| 196/196 [00:00<00:00, 204.53it/s]
100%|████████████████████████████████████████| 196/196 [00:00<00:00, 232.90it/s]
 86%|██████████████████████████████████▎     | 168/196 [00:00<00:00, 234.02it/s]
Client : 9 Number sample : 1960 Epoch : 0   Ep loss : 0.17438129137973396
Client : 9 Number sample : 1960 Epoch : 1   Ep loss : 0.17487566507592492
100%|████████████████████████████████████████| 196/196 [00:00<00:00, 235.80it/s]
100%|████████████████████████████████████████| 196/196 [00:00<00:00, 237.96it/s]
100%|████████████████████████████████████████| 196/196 [00:00<00:00, 241.34it/s]
 38%|███████████████▍                         | 74/196 [00:00<00:00, 240.97it/s]
Client : 9 Number sample : 1960 Epoch : 3   Ep loss : 0.1761124205908605
Client : 9 Number sample : 1960 Epoch : 4   Ep loss : 0.17518093178466876
100%|████████████████████████████████████████| 196/196 [00:00<00:00, 233.08it/s]
100%|████████████████████████████████████████| 196/196 [00:00<00:00, 236.46it/s]
































 99%|████████████████████████████████████████▋| 311/313 [01:04<00:00,  4.37it/s]
Train :------------------------------

100%|█████████████████████████████████████████| 313/313 [01:05<00:00,  3.66it/s]
  0%|                                                   | 0/196 [00:00<?, ?it/s]
Client : 0 Number sample : 1960 Epoch : 0   Ep loss : 2.0257691205764305
Client : 2 Number sample : 1960 Epoch : 0   Ep loss : 2.0256740104178994
Client : 1 Number sample : 1960 Epoch : 0   Ep loss : 2.025933102077367
100%|████████████████████████████████████████| 196/196 [00:00<00:00, 217.73it/s]
100%|████████████████████████████████████████| 196/196 [00:00<00:00, 219.83it/s]
100%|████████████████████████████████████████| 196/196 [00:00<00:00, 222.59it/s]
100%|████████████████████████████████████████| 196/196 [00:00<00:00, 221.18it/s]
 22%|████████▉                                | 43/196 [00:00<00:00, 198.49it/s]
Client : 3 Number sample : 1960 Epoch : 1   Ep loss : 0.9187131507360206
Client : 4 Number sample : 1960 Epoch : 0   Ep loss : 2.0254383604137267
Client : 3 Number sample : 1960 Epoch : 2   Ep loss : 0.43099076407296316
100%|████████████████████████████████████████| 196/196 [00:00<00:00, 224.93it/s]
100%|████████████████████████████████████████| 196/196 [00:00<00:00, 212.64it/s]
100%|████████████████████████████████████████| 196/196 [00:00<00:00, 224.47it/s]
100%|████████████████████████████████████████| 196/196 [00:00<00:00, 220.57it/s]
 59%|███████████████████████▍                | 115/196 [00:00<00:00, 225.94it/s]
Client : 3 Number sample : 1960 Epoch : 3   Ep loss : 0.39214082579223475
Client : 5 Number sample : 1960 Epoch : 1   Ep loss : 0.8842677350859253
Client : 3 Number sample : 1960 Epoch : 4   Ep loss : 0.35352652094193865
100%|████████████████████████████████████████| 196/196 [00:00<00:00, 226.84it/s]
100%|████████████████████████████████████████| 196/196 [00:00<00:00, 221.67it/s]
100%|████████████████████████████████████████| 196/196 [00:00<00:00, 223.87it/s]
100%|████████████████████████████████████████| 196/196 [00:00<00:00, 224.54it/s]
 83%|█████████████████████████████████▎      | 163/196 [00:00<00:00, 227.50it/s]
Client : 3 Number sample : 1960 Epoch : 5   Ep loss : 0.321472203397021
Client : 5 Number sample : 1960 Epoch : 3   Ep loss : 0.3943016133746322
Client : 3 Number sample : 1960 Epoch : 6   Ep loss : 0.29687207138964106
Client : 5 Number sample : 1960 Epoch : 4   Ep loss : 0.3526762033603629
100%|████████████████████████████████████████| 196/196 [00:00<00:00, 226.64it/s]
100%|████████████████████████████████████████| 196/196 [00:00<00:00, 225.13it/s]
100%|████████████████████████████████████████| 196/196 [00:00<00:00, 226.36it/s]
100%|████████████████████████████████████████| 196/196 [00:00<00:00, 220.59it/s]
100%|████████████████████████████████████████| 196/196 [00:00<00:00, 225.76it/s]
100%|████████████████████████████████████████| 196/196 [00:00<00:00, 226.00it/s]
 23%|█████████▌                               | 46/196 [00:00<00:00, 225.52it/s]
Client : 6 Number sample : 1960 Epoch : 0   Ep loss : 2.033862830424795
Client : 3 Number sample : 1960 Epoch : 8   Ep loss : 0.2591762830104147
Client : 7 Number sample : 1960 Epoch : 0   Ep loss : 2.0389338372921455
Client : 3 Number sample : 1960 Epoch : 9   Ep loss : 0.25601124474588705
100%|████████████████████████████████████████| 196/196 [00:00<00:00, 222.61it/s]
100%|████████████████████████████████████████| 196/196 [00:00<00:00, 222.83it/s]
100%|████████████████████████████████████████| 196/196 [00:00<00:00, 215.24it/s]
100%|████████████████████████████████████████| 196/196 [00:00<00:00, 222.04it/s]
 47%|███████████████████▏                     | 92/196 [00:00<00:00, 224.74it/s]
Client : 3 Number sample : 1960 Epoch : 10   Ep loss : 0.25573184462834375
Client : 7 Number sample : 1960 Epoch : 2   Ep loss : 1.5032203477256152
Client : 3 Number sample : 1960 Epoch : 11   Ep loss : 0.25478277157764045
100%|████████████████████████████████████████| 196/196 [00:00<00:00, 220.98it/s]
100%|████████████████████████████████████████| 196/196 [00:00<00:00, 219.35it/s]
100%|████████████████████████████████████████| 196/196 [00:00<00:00, 220.48it/s]
100%|████████████████████████████████████████| 196/196 [00:00<00:00, 224.14it/s]
 70%|███████████████████████████▉            | 137/196 [00:00<00:00, 222.50it/s]
Client : 3 Number sample : 1960 Epoch : 12   Ep loss : 0.25519571673809266
Client : 7 Number sample : 1960 Epoch : 4   Ep loss : 1.3417760176318032
Client : 3 Number sample : 1960 Epoch : 13   Ep loss : 0.25502188161623723
100%|████████████████████████████████████████| 196/196 [00:00<00:00, 224.64it/s]
100%|████████████████████████████████████████| 196/196 [00:00<00:00, 223.82it/s]
100%|████████████████████████████████████████| 196/196 [00:00<00:00, 220.84it/s]
100%|████████████████████████████████████████| 196/196 [00:00<00:00, 215.64it/s]
100%|████████████████████████████████████████| 196/196 [00:00<00:00, 225.90it/s]
100%|████████████████████████████████████████| 196/196 [00:00<00:00, 227.07it/s]
 47%|███████████████████▏                     | 92/196 [00:00<00:00, 224.72it/s]
Process SpawnPoolWorker-4:
Process SpawnPoolWorker-5:
Traceback (most recent call last):
  File "/usr/lib/python3.6/multiprocessing/process.py", line 258, in _bootstrap
    self.run()
  File "/usr/lib/python3.6/multiprocessing/process.py", line 93, in run
    self._target(*self._args, **self._kwargs)
  File "/usr/lib/python3.6/multiprocessing/pool.py", line 119, in worker
    result = (True, func(*args, **kwds))
  File "/usr/lib/python3.6/multiprocessing/pool.py", line 44, in mapstar
    return list(map(*args))
  File "/home/aimenext/workspace/dungnt/LongND-FL-Parallel-Computing/utils/trainer.py", line 42, in train
    optimizer.step()
  File "/home/aimenext/.local/lib/python3.6/site-packages/torch/optim/optimizer.py", line 87, in wrapper
    with torch.autograd.profiler.record_function(profile_name):
  File "/home/aimenext/.local/lib/python3.6/site-packages/torch/autograd/profiler.py", line 432, in __init__
    self.handle: torch.Tensor = torch.zeros(1)
KeyboardInterrupt
Traceback (most recent call last):
  File "/usr/lib/python3.6/multiprocessing/process.py", line 258, in _bootstrap
    self.run()
  File "/usr/lib/python3.6/multiprocessing/process.py", line 93, in run
    self._target(*self._args, **self._kwargs)
  File "/usr/lib/python3.6/multiprocessing/pool.py", line 119, in worker
    result = (True, func(*args, **kwds))
  File "/usr/lib/python3.6/multiprocessing/pool.py", line 44, in mapstar
    return list(map(*args))
  File "/home/aimenext/workspace/dungnt/LongND-FL-Parallel-Computing/utils/trainer.py", line 41, in train
    loss.backward()
  File "/home/aimenext/.local/lib/python3.6/site-packages/torch/_tensor.py", line 307, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph, inputs=inputs)
  File "/home/aimenext/.local/lib/python3.6/site-packages/torch/autograd/__init__.py", line 156, in backward
    allow_unreachable=True, accumulate_grad=True)  # allow_unreachable flag
KeyboardInterrupt
Traceback (most recent call last):
  File "train_SGD.py", line 231, in <module>
    main(args)
  File "train_SGD.py", line 162, in main
    for i in range(len(train_clients))
  File "/usr/lib/python3.6/multiprocessing/pool.py", line 266, in map
    return self._map_async(func, iterable, mapstar, chunksize).get()
  File "/usr/lib/python3.6/multiprocessing/pool.py", line 638, in get
    self.wait(timeout)
  File "/usr/lib/python3.6/multiprocessing/pool.py", line 635, in wait
    self._event.wait(timeout)
  File "/usr/lib/python3.6/threading.py", line 551, in wait
    signaled = self._cond.wait(timeout)
  File "/usr/lib/python3.6/threading.py", line 295, in wait
    waiter.acquire()
KeyboardInterrupt
Traceback (most recent call last):
  File "train_SGD.py", line 231, in <module>
    main(args)
  File "train_SGD.py", line 162, in main
    for i in range(len(train_clients))
  File "/usr/lib/python3.6/multiprocessing/pool.py", line 266, in map
    return self._map_async(func, iterable, mapstar, chunksize).get()
  File "/usr/lib/python3.6/multiprocessing/pool.py", line 638, in get
    self.wait(timeout)
  File "/usr/lib/python3.6/multiprocessing/pool.py", line 635, in wait
    self._event.wait(timeout)
  File "/usr/lib/python3.6/threading.py", line 551, in wait
    signaled = self._cond.wait(timeout)
  File "/usr/lib/python3.6/threading.py", line 295, in wait
    waiter.acquire()
KeyboardInterrupt
Client : 3 Number sample : 1960 Epoch : 14   Ep loss : 0.2546741518439079
Client : 7 Number sample : 1960 Epoch : 6   Ep loss : 1.2866779979394407